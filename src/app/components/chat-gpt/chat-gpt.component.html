<div *ngIf="showChat" class="chatgpt-container">
  <div class="chat-header">
    <h3>ðŸ¤– Asistente IA</h3>
    <button class="close-button" (click)="onCloseChat()">âœ•</button>
  </div>

  <div class="chat-box">
    <div *ngFor="let msg of messages" class="message" [ngClass]="msg.role">
      <strong *ngIf="msg.role === 'user'">TÃº:</strong>
      <strong *ngIf="msg.role === 'assistant'">GPT:</strong>
      {{ msg.content }}
    </div>
  </div>

  <div class="chat-input">
    <input
      [(ngModel)]="userMessage"
      placeholder="Escribe tu duda o habla..."
      (keypress)="onKeyPress($event)"
      [disabled]="isListening" />
    <button (click)="sendMessage()" [disabled]="!userMessage.trim() || isListening">
      Enviar
    </button>
    <button
      (click)="onStartListening()"
      [disabled]="isListening"
      class="voice-button"
      title="Habla tu duda">
      ðŸŽ¤ {{ isListening ? 'Escuchando...' : '' }}
    </button>
  </div>

  <div *ngIf="isListening" class="listening-indicator">
    ðŸŽ¤ Escuchando...
  </div>
</div>
