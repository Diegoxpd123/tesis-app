<div class="table-wrapper" [class.dark-theme]="isDarkMode">
  <!-- Loading State -->
  <div class="loading-container" *ngIf="loading">
    <div class="loading-spinner">
      <div class="spinner"></div>
      <p>Cargando estudiantes...</p>
    </div>
  </div>

  <!-- Empty State -->
  <div class="empty-container" *ngIf="!loading && estudiantes.length === 0">
    <div class="empty-content">
      <div class="empty-icon">ðŸ‘¥</div>
      <h3>{{ emptyMessage }}</h3>
      <p>No hay estudiantes registrados en el sistema</p>
    </div>
  </div>

  <!-- Table -->
  <div class="table-container" *ngIf="!loading && estudiantes.length > 0">
    <div class="table-responsive">
      <table class="students-table">
        <thead>
          <tr>
            <th class="th-avatar">Avatar</th>
            <th class="th-name">Estudiante</th>
            <th class="th-grade">Grado</th>
            <th class="th-section">SecciÃ³n</th>
            <th class="th-progress" *ngIf="showProgressColumns">Progreso</th>
            <th class="th-status" *ngIf="showProgressColumns">Estado</th>
            <th class="th-actions">Acciones</th>
          </tr>
        </thead>
        <tbody>
          <tr
            *ngFor="let estudiante of estudiantes; trackBy: trackByEstudianteId; let i = index"
            class="student-row"
            [class.hovered]="isRowHovered(estudiante.id)"
            [class.odd]="i % 2 === 0"
            (mouseenter)="onRowHover(estudiante.id)"
            (mouseleave)="onRowHover(null)"
            [style.animation-delay]="(i * 0.1) + 's'">

            <!-- Avatar -->
            <td class="td-avatar">
              <div class="student-avatar">
                <div class="avatar-circle">
                  <img src="assets/img/robot.png" alt="Robot" class="avatar-robot" />
                </div>
                <div class="avatar-status" [class]="getEstadoClass(estudiante.porcentaje)"></div>
              </div>
            </td>

            <!-- Nombre -->
            <td class="td-name">
              <div class="student-info">
                <h4 class="student-name">{{ estudiante.nombre }}</h4>
                <p class="student-id">ID: {{ estudiante.id }}</p>
              </div>
            </td>

            <!-- Grado -->
            <td class="td-grade">
              <div class="grade-badge">
                <span class="grade-number">{{ estudiante.grado }}</span>
                <span class="grade-text">Â° Grado</span>
              </div>
            </td>

            <!-- SecciÃ³n -->
            <td class="td-section">
              <div class="section-badge">
                <span class="section-letter">{{ getSeccionLetra(estudiante.seccionid) }}</span>
              </div>
            </td>

            <!-- Progreso -->
            <td class="td-progress" *ngIf="showProgressColumns">
              <div class="progress-container">
                <div class="progress-info">
                  <span class="progress-percentage">{{ estudiante.porcentaje }}%</span>
                  <span class="progress-icon">{{ getProgressIcon(estudiante.porcentaje) }}</span>
                </div>
                <div class="progress-bar">
                  <div
                    class="progress-fill"
                    [style.width]="getProgressWidth(estudiante.porcentaje)"
                    [style.background-color]="getProgressColor(estudiante.porcentaje)">
                  </div>
                </div>
              </div>
            </td>

            <!-- Estado -->
            <td class="td-status" *ngIf="showProgressColumns">
              <div class="status-badge" [class]="getEstadoClass(estudiante.porcentaje)">
                <span class="status-icon">{{ getProgressIcon(estudiante.porcentaje) }}</span>
                <span class="status-text">{{ getEstadoText(estudiante.porcentaje) }}</span>
              </div>
            </td>

            <!-- Acciones -->
            <td class="td-actions">
              <button
                class="action-btn details-btn"
                (click)="onVerDetalles(estudiante.id)"
                title="Ver detalles del estudiante">
                <svg viewBox="0 0 24 24" fill="currentColor">
                  <path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>
                </svg>
                <span>Ver Detalles</span>
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
