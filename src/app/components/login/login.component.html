<!-- login.component.html -->
<div class="login-container no-navbar-padding" [class.dark-theme]="isDarkMode">
  <!-- Lado Izquierdo -->
  <div class="login-left">
    <img src="assets/img/logo.png" alt="Logo" class="logo" />

    <h1 class="titulo">
      <span class="azul">DREAN </span>
      <span class="amarillo">TEACH </span>
      <span class="azul">ME</span>
    </h1>

    <h2 class="subtitulo">¡Bienvenido! Ingresa tus datos</h2>

    <form [formGroup]="loginForm" (ngSubmit)="login()" class="formulario">
      <!-- Campo Usuario -->
      <div class="campo">
        <label for="username" class="form-label">Usuario</label>
        <div class="input-icono">
          <input
            type="text"
            class="form-control"
            id="username"
            formControlName="username"
            placeholder="Ingresa tu usuario"
            [class.error]="hasFieldError('username')"
            autocomplete="username"
          />
          <i class="fas fa-user"></i>
        </div>
        <div *ngIf="hasFieldError('username')" class="error-message">
          {{ getFieldError('username') }}
        </div>
      </div>

      <!-- Campo Contraseña -->
      <div class="campo">
        <label for="password" class="form-label">Contraseña</label>
        <div class="input-icono">
          <input
            [type]="showPassword ? 'text' : 'password'"
            class="form-control"
            id="password"
            formControlName="password"
            placeholder="Ingresa tu contraseña"
            [class.error]="hasFieldError('password')"
            autocomplete="current-password"
          />
          <i
            class="fas"
            [class.fa-eye]="!showPassword"
            [class.fa-eye-slash]="showPassword"
            (click)="togglePasswordVisibility()"
            title="Mostrar/Ocultar contraseña"
          ></i>
        </div>
        <div *ngIf="hasFieldError('password')" class="error-message">
          {{ getFieldError('password') }}
        </div>
      </div>

      <!-- Botón de Login -->
      <button
        type="submit"
        class="btn btn-primary"
        [disabled]="loginForm.invalid || loading"
        [class.loading]="loading"
      >
        <span *ngIf="!loading" class="btn-text">
          <i class="fas fa-sign-in-alt"></i>
          Iniciar sesión
        </span>
        <span *ngIf="loading" class="btn-loading">
          <div class="spinner"></div>
          Iniciando sesión...
        </span>
      </button>

      <!-- Olvidé mi contraseña -->
      <div class="forgot-password-link">
        <button type="button" class="forgot-password-btn" (click)="goToForgotPassword()">
          <i class="fas fa-key"></i>
          ¿Olvidaste tu contraseña?
        </button>
      </div>

      <!-- Mensaje de Estado -->
      <div *ngIf="mensajeLogin" class="status-message" [class.error]="colorMensaje === 'red'">
        <i class="fas" [class.fa-check-circle]="colorMensaje === 'green'" [class.fa-exclamation-circle]="colorMensaje === 'red'"></i>
        {{ mensajeLogin }}
      </div>

      <!-- Información de Bloqueo -->
      <div *ngIf="isBlocked && blockTime > 0" class="block-message">
        <i class="fas fa-lock"></i>
        <p>Demasiados intentos fallidos</p>
        <p>Intenta de nuevo en {{ Math.ceil((blockTime - Date.now()) / 1000 / 60) }} minutos</p>
      </div>
    </form>
  </div>

  <!-- Lado Derecho -->
  <div class="login-right">
    <img src="assets/img/plantilla.png" alt="Decoración divertida para niños" />
  </div>
</div>

<!-- Modal de Términos y Políticas (Primer Login) -->
<app-terms-privacy-modal
  *ngIf="showTermsModal"
  (accepted)="onTermsAccepted()"
  (rejected)="onTermsRejected()">
</app-terms-privacy-modal>
